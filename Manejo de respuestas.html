<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.0/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.0/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.0/dist/index.js"></script><script>(()=>{setTimeout(()=>{const{markmap:q,mm:v}=window,j=new q.Toolbar;j.attach(v);const we=j.render();we.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(we)})})()</script><script>((f,d,h,u)=>{const g=f();window.mm=g.Markmap.create("svg#mindmap",(d||g.deriveOptions)(u),h)})(()=>window.markmap,null,{"content":"Manejo de Respuestas y Errores","children":[{"content":"ResponseHandler","children":[{"content":"Respuestas Exitosas","children":[{"content":"<strong>Método: <code>sendSuccessResponse</code></strong>","children":[{"content":"<strong>Descripción:</strong> Envía una respuesta de éxito al cliente con los datos proporcionados.","children":[],"payload":{"lines":"5,6"}},{"content":"<strong>Parámetros:</strong>","children":[{"content":"<strong><code>res</code> (Response):</strong> Objeto de respuesta HTTP.","children":[],"payload":{"lines":"7,8"}},{"content":"<strong><code>data</code> (any):</strong> Datos a incluir en la respuesta.","children":[],"payload":{"lines":"8,9"}},{"content":"<strong><code>message</code> (string, opcional):</strong> Mensaje opcional para proporcionar contexto adicional.","children":[],"payload":{"lines":"9,10"}},{"content":"<strong><code>statusCode</code> (number, opcional):</strong> Código de estado HTTP (default 200).","children":[],"payload":{"lines":"10,11"}}],"payload":{"lines":"6,11"}},{"content":"<strong>Código:</strong><pre><code class=\"language-typescript\"><span class=\"hljs-comment\">// src/utils/responseHandler.ts</span>\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Response</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"express\"</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ResponseHandler</span> {\n  <span class=\"hljs-keyword\">static</span> <span class=\"hljs-title function_\">sendSuccessResponse</span>(<span class=\"hljs-params\">\n    res: Response,\n    data: <span class=\"hljs-built_in\">any</span>,\n    message?: <span class=\"hljs-built_in\">string</span>,\n    statusCode: <span class=\"hljs-built_in\">number</span> = <span class=\"hljs-number\">200</span>\n  </span>) {\n    res.<span class=\"hljs-title function_\">status</span>(statusCode).<span class=\"hljs-title function_\">json</span>({\n      <span class=\"hljs-attr\">success</span>: <span class=\"hljs-literal\">true</span>,\n      <span class=\"hljs-attr\">message</span>: message || <span class=\"hljs-string\">'Request successful'</span>,\n      <span class=\"hljs-attr\">data</span>: data\n    });\n  }\n}\n</code></pre>","children":[],"payload":{"lines":"11,31"}},{"content":"<strong>Ejemplo de Uso:</strong><pre><code class=\"language-typescript\"><span class=\"hljs-title class_\">ResponseHandler</span>.<span class=\"hljs-title function_\">sendSuccessResponse</span>(res, users, <span class=\"hljs-string\">'Users fetched successfully'</span>);\n</code></pre>","children":[],"payload":{"lines":"31,36"}}],"payload":{"lines":"4,36"}}],"payload":{"lines":"3,4"}},{"content":"Respuestas de Error","children":[{"content":"<strong>Método: <code>sendErrorResponse</code></strong>","children":[{"content":"<strong>Descripción:</strong> Envía una respuesta de error al cliente con información sobre el error.","children":[],"payload":{"lines":"38,39"}},{"content":"<strong>Parámetros:</strong>","children":[{"content":"<strong><code>res</code> (Response):</strong> Objeto de respuesta HTTP.","children":[],"payload":{"lines":"40,41"}},{"content":"<strong><code>error</code> (any):</strong> Información sobre el error, incluyendo código y mensaje.","children":[],"payload":{"lines":"41,42"}},{"content":"<strong><code>statusCode</code> (number, opcional):</strong> Código de estado HTTP (default 500).","children":[],"payload":{"lines":"42,43"}}],"payload":{"lines":"39,43"}},{"content":"<strong>Código:</strong><pre><code class=\"language-typescript\"><span class=\"hljs-comment\">// src/utils/responseHandler.ts</span>\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Response</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"express\"</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ResponseHandler</span> {\n  <span class=\"hljs-keyword\">static</span> <span class=\"hljs-title function_\">sendErrorResponse</span>(<span class=\"hljs-params\">\n    res: Response,\n    error: <span class=\"hljs-built_in\">any</span>,\n    statusCode: <span class=\"hljs-built_in\">number</span> = <span class=\"hljs-number\">500</span>\n  </span>) {\n    res.<span class=\"hljs-title function_\">status</span>(statusCode).<span class=\"hljs-title function_\">json</span>({\n      <span class=\"hljs-attr\">success</span>: <span class=\"hljs-literal\">false</span>,\n      <span class=\"hljs-attr\">error</span>: {\n        <span class=\"hljs-attr\">code</span>: error.<span class=\"hljs-property\">code</span> || <span class=\"hljs-string\">'UNKNOWN_ERROR'</span>,\n        <span class=\"hljs-attr\">message</span>: error.<span class=\"hljs-property\">message</span> || <span class=\"hljs-string\">'An error occurred'</span>,\n        <span class=\"hljs-attr\">details</span>: error.<span class=\"hljs-property\">details</span> || <span class=\"hljs-literal\">null</span>\n      }\n    });\n  }\n}\n</code></pre>","children":[],"payload":{"lines":"43,65"}},{"content":"<strong>Ejemplo de Uso:</strong><pre><code class=\"language-typescript\"><span class=\"hljs-title class_\">ResponseHandler</span>.<span class=\"hljs-title function_\">sendErrorResponse</span>(res, {\n  <span class=\"hljs-attr\">code</span>: <span class=\"hljs-string\">'VALIDATION_ERROR'</span>,\n  <span class=\"hljs-attr\">message</span>: <span class=\"hljs-string\">'Invalid input data'</span>,\n  <span class=\"hljs-attr\">details</span>: error.<span class=\"hljs-property\">details</span>\n}, <span class=\"hljs-number\">400</span>);\n</code></pre>","children":[],"payload":{"lines":"65,74"}}],"payload":{"lines":"37,74"}}],"payload":{"lines":"36,37"}}],"payload":{"lines":"2,3"}},{"content":"Mejoras Adicionales","children":[{"content":"Formateo de Mensajes de Error","children":[{"content":"<strong>Descripción:</strong> Mejorar el formateo de los mensajes de error para proporcionar más contexto o detalles específicos del error, lo que puede ayudar a los desarrolladores a entender el problema.","children":[],"payload":{"lines":"76,78"}}],"payload":{"lines":"75,76"}},{"content":"Manejo de Tipos de Error Específicos","children":[{"content":"<strong>Descripción:</strong> Implementar lógica para manejar diferentes tipos de errores de manera específica, como errores de validación, errores de base de datos, etc., y responder con códigos de estado y mensajes apropiados.","children":[],"payload":{"lines":"79,81"}}],"payload":{"lines":"78,79"}},{"content":"Respuesta para Errores No Capturados","children":[{"content":"<strong>Descripción:</strong> Añadir un manejo para errores inesperados o no capturados que asegure que siempre se envíe una respuesta adecuada al cliente, incluso si el error no es manejado específicamente.","children":[],"payload":{"lines":"82,84"}}],"payload":{"lines":"81,82"}},{"content":"Configuración de Niveles de Severidad","children":[{"content":"<strong>Descripción:</strong> Implementar niveles de severidad en los mensajes de error para distinguir entre errores críticos y errores menos graves. Esto puede ayudar en el registro y manejo de errores.","children":[],"payload":{"lines":"85,87"}}],"payload":{"lines":"84,85"}}],"payload":{"lines":"74,75"}},{"content":"Manejo Global de Errores","children":[{"content":"Middleware de Manejo Global de Errores","children":[{"content":"<strong>Descripción:</strong> Clase personalizada para manejar errores operacionales en la aplicación.","children":[],"payload":{"lines":"89,90"}},{"content":"<strong>Propiedades:</strong>","children":[{"content":"<strong><code>statusCode</code> (number):</strong> Código de estado HTTP.","children":[],"payload":{"lines":"91,92"}},{"content":"<strong><code>status</code> (string):</strong> Estado del error ('fail' para errores de cliente, 'error' para errores de servidor).","children":[],"payload":{"lines":"92,93"}},{"content":"<strong><code>isOperational</code> (boolean):</strong> Indica si el error es operativo o no.","children":[],"payload":{"lines":"93,94"}},{"content":"<strong>Código:</strong><pre><code class=\"language-typescript\"><span class=\"hljs-comment\">// src/utils/errorHandler.ts</span>\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">AppError</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_ inherited__\">Error</span> {\n    <span class=\"hljs-attr\">statusCode</span>: <span class=\"hljs-built_in\">number</span>;\n    <span class=\"hljs-attr\">status</span>: <span class=\"hljs-built_in\">string</span>;\n    <span class=\"hljs-attr\">isOperational</span>: <span class=\"hljs-built_in\">boolean</span>;\n\n    <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\">message: <span class=\"hljs-built_in\">string</span>, statusCode: <span class=\"hljs-built_in\">number</span></span>) {\n      <span class=\"hljs-variable language_\">super</span>(message);\n    \n      <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">statusCode</span> = statusCode;\n      <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">status</span> = <span class=\"hljs-string\">`<span class=\"hljs-subst\">${statusCode}</span>`</span>.<span class=\"hljs-title function_\">startsWith</span>(<span class=\"hljs-string\">'4'</span>) ? <span class=\"hljs-string\">'fail'</span> : <span class=\"hljs-string\">'error'</span>;\n      <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">isOperational</span> = <span class=\"hljs-literal\">true</span>;\n\n      <span class=\"hljs-title class_\">Error</span>.<span class=\"hljs-title function_\">captureStackTrace</span>(<span class=\"hljs-variable language_\">this</span>, <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">constructor</span>);\n    }\n}\n\n<span class=\"hljs-comment\">// Middleware para manejar errores globales</span>\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">globalErrorHandler</span> = (<span class=\"hljs-params\">err: <span class=\"hljs-built_in\">any</span>, req: <span class=\"hljs-built_in\">any</span>, res: <span class=\"hljs-built_in\">any</span>, next: <span class=\"hljs-built_in\">any</span></span>) =&gt; {\n  err.<span class=\"hljs-property\">statusCode</span> = err.<span class=\"hljs-property\">statusCode</span> || <span class=\"hljs-number\">500</span>;\n  err.<span class=\"hljs-property\">status</span> = err.<span class=\"hljs-property\">status</span> || <span class=\"hljs-string\">'error'</span>;\n\n  res.<span class=\"hljs-title function_\">status</span>(err.<span class=\"hljs-property\">statusCode</span>).<span class=\"hljs-title function_\">json</span>({\n    <span class=\"hljs-attr\">status</span>: err.<span class=\"hljs-property\">status</span>,\n    <span class=\"hljs-attr\">message</span>: err.<span class=\"hljs-property\">message</span>\n    });\n};\n</code></pre>","children":[],"payload":{"lines":"94,123"}}],"payload":{"lines":"90,123"}},{"content":"<strong>Uso en la Aplicación:</strong><pre><code class=\"language-typescript\"><span class=\"hljs-comment\">// src/app.ts (o server.ts)</span>\n<span class=\"hljs-keyword\">import</span> express <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"express\"</span>;\n<span class=\"hljs-keyword\">import</span> { globalErrorHandler } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./utils/errorHandler\"</span>;\n\n<span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">express</span>();\n\n<span class=\"hljs-comment\">// Tus rutas y middleware aquí</span>\n\n<span class=\"hljs-comment\">// Manejo global de errores al final</span>\napp.<span class=\"hljs-title function_\">use</span>(globalErrorHandler);\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> app;\n</code></pre>","children":[],"payload":{"lines":"123,139"}}],"payload":{"lines":"88,89"}}],"payload":{"lines":"87,88"}}],"payload":{"lines":"0,1"}},null)</script>
</body>
</html>
