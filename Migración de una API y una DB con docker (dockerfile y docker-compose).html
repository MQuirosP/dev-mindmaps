<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.3-alpha.1/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.3-alpha.1/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.3-alpha.1/dist/index.js"></script><script>(()=>{setTimeout(()=>{const{markmap:q,mm:v}=window,j=new q.Toolbar;j.attach(v);const we=j.render();we.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(we)})})()</script><script>((f,d,h,u)=>{const g=f();window.mm=g.Markmap.create("svg#mindmap",(d||g.deriveOptions)(u),h)})(()=>window.markmap,null,{"content":"Migración de una API y base de datos con Docker","children":[{"content":"Generalidades sobre configuraciones para Docker","children":[{"content":"<strong>Docker</strong> permite empaquetar aplicaciones y sus dependencias en contenedores que se pueden ejecutar en cualquier entorno.","children":[],"payload":{"lines":"3,4"}},{"content":"<strong>Docker Compose</strong> se usa para definir y ejecutar aplicaciones multicontenedor. En este caso, se utiliza para manejar los contenedores de la API y la base de datos PostgreSQL.","children":[],"payload":{"lines":"4,5"}},{"content":"<strong>Node.js/Express</strong>:","children":[{"content":"Se usa como servidor para la API.","children":[],"payload":{"lines":"6,7"}},{"content":"La configuración en Docker asegura que el contenedor de la API corra el código con todas sus dependencias.","children":[],"payload":{"lines":"7,8"}}],"payload":{"lines":"5,8"}},{"content":"<strong>PostgreSQL</strong>:","children":[{"content":"Se utiliza como base de datos.","children":[],"payload":{"lines":"9,10"}},{"content":"Configuración en Docker especifica variables como <code>POSTGRES_USER</code>, <code>POSTGRES_PASSWORD</code> y <code>POSTGRES_DB</code>.","children":[],"payload":{"lines":"10,11"}}],"payload":{"lines":"8,11"}},{"content":"<strong>Persistencia de datos</strong>:","children":[{"content":"Se utiliza un volumen Docker (<code>db_data</code>) para asegurar que los datos de la base de datos no se pierdan al detener el contenedor.","children":[],"payload":{"lines":"12,14"}}],"payload":{"lines":"11,14"}}],"payload":{"lines":"2,3"}},{"content":"Explicación de <code>docker-compose.yml</code>","children":[{"content":"<strong>services</strong>: Define los contenedores que forman parte de la aplicación.","children":[{"content":"<strong>db</strong>:","children":[{"content":"<strong>image</strong>: Utiliza la imagen de PostgreSQL 17.","children":[],"payload":{"lines":"17,18"}},{"content":"<strong>container_name</strong>: Nombre del contenedor de la base de datos, <code>postgres_db</code>.","children":[],"payload":{"lines":"18,19"}},{"content":"<strong>environment</strong>:","children":[{"content":"<code>POSTGRES_USER</code>: Usuario para acceder a la base de datos (<code>postgres</code>).","children":[],"payload":{"lines":"20,21"}},{"content":"<code>POSTGRES_PASSWORD</code>: Contraseña para el usuario (<code>3az5bkhr</code>).","children":[],"payload":{"lines":"21,22"}},{"content":"<code>POSTGRES_DB</code>: Nombre de la base de datos a crear (<code>verduleria_db</code>).","children":[],"payload":{"lines":"22,23"}}],"payload":{"lines":"19,23"}},{"content":"<strong>volumes</strong>:","children":[{"content":"Se utiliza un volumen <code>db_data</code> para persistir los datos de la base de datos.","children":[],"payload":{"lines":"24,25"}}],"payload":{"lines":"23,25"}},{"content":"<strong>ports</strong>:","children":[{"content":"Mapea el puerto <code>5432</code> del contenedor al puerto <code>5432</code> de la máquina host para acceso a la base de datos desde fuera del contenedor.","children":[],"payload":{"lines":"26,27"}}],"payload":{"lines":"25,27"}}],"payload":{"lines":"16,27"}},{"content":"<strong>api</strong>:","children":[{"content":"<strong>build</strong>: Define el contexto para construir la imagen, apuntando a la carpeta <code>./backend</code> (donde reside el código fuente).","children":[],"payload":{"lines":"28,29"}},{"content":"<strong>container_name</strong>: Nombre del contenedor de la API (<code>node-api</code>).","children":[],"payload":{"lines":"29,30"}},{"content":"<strong>environment</strong>:","children":[{"content":"<code>DATABASE_URL</code>: URL de conexión a la base de datos PostgreSQL usando las credenciales y el nombre de la base de datos.","children":[],"payload":{"lines":"31,32"}},{"content":"<code>NODE_ENV</code>: Define el entorno de ejecución de Node.js, en este caso <code>production</code>.","children":[],"payload":{"lines":"32,33"}}],"payload":{"lines":"30,33"}},{"content":"<strong>ports</strong>:","children":[{"content":"Mapea el puerto <code>3000</code> del contenedor al puerto <code>3000</code> de la máquina host para exponer la API.","children":[],"payload":{"lines":"34,35"}}],"payload":{"lines":"33,35"}},{"content":"<strong>depends_on</strong>:","children":[{"content":"Define que el contenedor de la API depende del contenedor <code>db</code>, garantizando que la base de datos esté lista antes de iniciar la API.","children":[],"payload":{"lines":"36,37"}}],"payload":{"lines":"35,37"}}],"payload":{"lines":"27,37"}}],"payload":{"lines":"15,37"}},{"content":"<strong>volumes</strong>: Define los volúmenes de datos. En este caso, se utiliza <code>db_data</code> para persistir los datos de PostgreSQL.","children":[],"payload":{"lines":"37,39"}}],"payload":{"lines":"14,15"}},{"content":"Explicación de <code>Dockerfile</code>","children":[{"content":"<strong>FROM node:20</strong>: Usa la imagen base oficial de Node.js 20 como base para crear el contenedor de la API.","children":[],"payload":{"lines":"40,41"}},{"content":"<strong>WORKDIR /backend</strong>: Establece el directorio de trabajo dentro del contenedor en <code>/backend</code>. Este será el lugar donde se almacenará el código fuente de la API.","children":[],"payload":{"lines":"41,42"}},{"content":"<em><em>COPY backend/package</em>.json ./</em>*: Copia los archivos <code>package.json</code> y <code>package-lock.json</code> desde la carpeta <code>backend</code> de la máquina local al contenedor. Esto se hace para instalar las dependencias de la aplicación.","children":[],"payload":{"lines":"42,43"}},{"content":"<strong>RUN npm install</strong>: Ejecuta <code>npm install</code> dentro del contenedor para instalar las dependencias de Node.js de la API.","children":[],"payload":{"lines":"43,44"}},{"content":"<strong>COPY backend ./</strong>: Copia todo el código fuente desde la carpeta <code>backend</code> en la máquina local al directorio de trabajo del contenedor.","children":[],"payload":{"lines":"44,45"}},{"content":"<strong>EXPOSE 3000</strong>: Expone el puerto <code>3000</code> del contenedor, que es el puerto en el que la API escucha por solicitudes.","children":[],"payload":{"lines":"45,46"}},{"content":"<strong>CMD [\"npm\", \"start\"]</strong>: Define el comando para iniciar la aplicación, ejecutando <code>npm start</code> cuando el contenedor se inicia.","children":[],"payload":{"lines":"46,48"}}],"payload":{"lines":"39,40"}},{"content":"Flujo completo","children":[{"content":"1. \n<p data-lines=\"49,50\"><strong>En el origen (desarrollo):</strong></p>","children":[{"content":"Se prepara la aplicación en Node.js/Express.","children":[],"payload":{"lines":"50,51"}},{"content":"Se crea el archivo <code>Dockerfile</code> y <code>docker-compose.yml</code> para empaquetar la API y la base de datos PostgreSQL en contenedores Docker.","children":[],"payload":{"lines":"51,52"}},{"content":"Se genera la imagen de Docker para la API.","children":[],"payload":{"lines":"52,53"}},{"content":"Se exporta la imagen del contenedor y los archivos necesarios (<code>docker-compose.yml</code> y el respaldo de la base de datos).","children":[],"payload":{"lines":"53,55"}}],"payload":{"lines":"49,55","listIndex":1}},{"content":"2. \n<p data-lines=\"55,56\"><strong>En el destino (producción):</strong></p>","children":[{"content":"Se cargan las imágenes exportadas y se actualiza el archivo <code>docker-compose.yml</code> para ejecutar la API.","children":[],"payload":{"lines":"56,57"}},{"content":"Se restaura la base de datos desde el respaldo y se levanta el entorno usando Docker Compose.","children":[],"payload":{"lines":"57,58"}},{"content":"La API y la base de datos se ejecutan dentro de contenedores aislados, pero pueden comunicarse entre sí usando las variables de entorno configuradas.","children":[],"payload":{"lines":"58,60"}}],"payload":{"lines":"55,60","listIndex":2}}],"payload":{"lines":"48,49"}},{"content":"Consejos adicionales:","children":[{"content":"<strong>Construcción del contenedor</strong>: Si estás moviendo la API entre computadoras, puedes construir la imagen directamente en el contenedor de destino usando el archivo <code>Dockerfile</code>, eliminando la sección de <code>build</code> en <code>docker-compose.yml</code> si la imagen ya ha sido exportada.","children":[],"payload":{"lines":"61,62"}},{"content":"<strong>Persistencia de datos</strong>: Los volúmenes son esenciales para no perder datos cuando el contenedor se detiene o reinicia.","children":[],"payload":{"lines":"62,63"}},{"content":"<strong>Redes en Docker</strong>: Docker Compose crea automáticamente una red interna donde los contenedores pueden encontrarse por nombre de servicio, como <code>db</code> en <code>DATABASE_URL</code>.","children":[],"payload":{"lines":"63,65"}}],"payload":{"lines":"60,61"}},{"content":"Resumen","children":[{"content":"Docker facilita la creación, distribución y ejecución de aplicaciones completas en contenedores.","children":[],"payload":{"lines":"66,67"}},{"content":"La configuración con Docker Compose permite gestionar servicios como la API y la base de datos de forma eficiente y aislada.","children":[],"payload":{"lines":"67,68"}},{"content":"El proceso de migración incluye empaquetar la API y la base de datos, mover los archivos y configurarlos en el destino para su ejecución.","children":[],"payload":{"lines":"68,69"}}],"payload":{"lines":"65,66"}}],"payload":{"lines":"0,1"}},null)</script>
</body>
</html>
