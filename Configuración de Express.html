<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.0/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.0/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.0/dist/index.js"></script><script>(()=>{setTimeout(()=>{const{markmap:q,mm:v}=window,j=new q.Toolbar;j.attach(v);const we=j.render();we.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(we)})})()</script><script>((f,d,h,u)=>{const g=f();window.mm=g.Markmap.create("svg#mindmap",(d||g.deriveOptions)(u),h)})(()=>window.markmap,null,{"content":"Configuración de Express","children":[{"content":"1. Configuración General y Middlewares Básicos","children":[{"content":"\n<p data-lines=\"3,4\"><strong>Configuración de Entorno</strong></p>","children":[{"content":"\n<p data-lines=\"4,5\">Utiliza <code>dotenv</code> para cargar variables de entorno desde un archivo <code>.env</code>.</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> dotenv <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"dotenv\"</span>;\ndotenv.<span class=\"hljs-title function_\">config</span>();\n</code></pre>","children":[],"payload":{"lines":"4,11"}}],"payload":{"lines":"3,11"}},{"content":"\n<p data-lines=\"11,12\"><strong>Middleware de <code>cors</code></strong></p>","children":[{"content":"\n<p data-lines=\"12,13\">Permite solicitudes de diferentes orígenes (Cross-Origin Resource Sharing).</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> cors <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"cors\"</span>;\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">cors</span>());\n</code></pre>","children":[],"payload":{"lines":"12,19"}}],"payload":{"lines":"11,19"}},{"content":"\n<p data-lines=\"19,20\"><strong>Middleware de <code>bodyParser</code></strong></p>","children":[{"content":"\n<p data-lines=\"20,21\">Analiza cuerpos de solicitud JSON.</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> bodyParser <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"body-parser\"</span>;\napp.<span class=\"hljs-title function_\">use</span>(bodyParser.<span class=\"hljs-title function_\">json</span>());\n</code></pre>","children":[],"payload":{"lines":"20,27"}}],"payload":{"lines":"19,27"}},{"content":"\n<p data-lines=\"27,28\"><strong>Middleware de <code>helmet</code> (opcional)</strong></p>","children":[{"content":"\n<p data-lines=\"28,29\">Añade cabeceras HTTP seguras para mejorar la seguridad de la aplicación.</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> helmet <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"helmet\"</span>;\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">helmet</span>());\n</code></pre>","children":[],"payload":{"lines":"28,35"}}],"payload":{"lines":"27,35"}},{"content":"\n<p data-lines=\"35,36\"><strong>Middleware de <code>compression</code> (opcional)</strong></p>","children":[{"content":"\n<p data-lines=\"36,37\">Comprime respuestas HTTP para mejorar el rendimiento.</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> compression <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"compression\"</span>;\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">compression</span>());\n</code></pre>","children":[],"payload":{"lines":"36,43"}}],"payload":{"lines":"35,43"}}],"payload":{"lines":"2,3"}},{"content":"2. Middleware Específico de la Aplicación","children":[{"content":"<strong>Middleware de Respuesta Personalizado</strong>","children":[{"content":"\n<p data-lines=\"45,46\">Permite métodos personalizados como <code>success</code> y <code>error</code> en el objeto de respuesta.</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> { responseMiddleware } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./utils/responseMiddleware\"</span>;\napp.<span class=\"hljs-title function_\">use</span>(responseMiddleware);\n</code></pre>","children":[{"content":"\n<p data-lines=\"52,53\"><strong>Ejemplo de <code>responseMiddleware</code>:</strong></p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">NextFunction</span>, <span class=\"hljs-title class_\">Request</span>, <span class=\"hljs-title class_\">Response</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"express\"</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">responseMiddleware</span>(<span class=\"hljs-params\">\n  req: Request,\n  res: Response,\n  next: NextFunction\n</span>) {\n  res.<span class=\"hljs-property\">success</span> = <span class=\"hljs-function\">(<span class=\"hljs-params\">data: <span class=\"hljs-built_in\">any</span>, message?: <span class=\"hljs-built_in\">string</span>, statusCode?: <span class=\"hljs-built_in\">number</span></span>) =&gt;</span> {\n    res.<span class=\"hljs-title function_\">status</span>(statusCode || <span class=\"hljs-number\">200</span>).<span class=\"hljs-title function_\">json</span>({\n      <span class=\"hljs-attr\">success</span>: <span class=\"hljs-literal\">true</span>,\n      <span class=\"hljs-attr\">message</span>: message || <span class=\"hljs-string\">\"Request successful\"</span>,\n      data,\n      <span class=\"hljs-attr\">statusCode</span>: statusCode || <span class=\"hljs-number\">200</span>,\n    });\n  };\n\n  res.<span class=\"hljs-property\">error</span> = <span class=\"hljs-function\">(<span class=\"hljs-params\">error: <span class=\"hljs-built_in\">any</span>, statusCode?: <span class=\"hljs-built_in\">number</span></span>) =&gt;</span> {\n    res.<span class=\"hljs-title function_\">status</span>(statusCode || <span class=\"hljs-number\">500</span>).<span class=\"hljs-title function_\">json</span>({\n      <span class=\"hljs-attr\">success</span>: <span class=\"hljs-literal\">false</span>,\n      <span class=\"hljs-attr\">message</span>: error.<span class=\"hljs-property\">message</span> || <span class=\"hljs-string\">\"Internal Server Error\"</span>,\n      <span class=\"hljs-attr\">statusCode</span>: statusCode || <span class=\"hljs-number\">500</span>,\n    });\n  };\n\n  <span class=\"hljs-title function_\">next</span>();\n}\n</code></pre>","children":[],"payload":{"lines":"52,83"}}],"payload":{"lines":"45,83"}}],"payload":{"lines":"44,83"}}],"payload":{"lines":"43,44"}},{"content":"3. Definición de Rutas","children":[{"content":"<strong>Rutas de la Aplicación</strong>","children":[{"content":"\n<p data-lines=\"85,86\">Define las rutas y los controladores para manejar solicitudes.</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> routes <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./routes\"</span>;\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">\"/api/\"</span>, routes);\n</code></pre>","children":[{"content":"\n<p data-lines=\"92,93\"><strong>Ejemplo de rutas:</strong></p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> express <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"express\"</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">UserController</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./controllers/UserController\"</span>;\n\n<span class=\"hljs-keyword\">const</span> router = express.<span class=\"hljs-title class_\">Router</span>();\n<span class=\"hljs-keyword\">const</span> userController = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UserController</span>();\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">\"/users\"</span>, userController.<span class=\"hljs-property\">getUsers</span>);\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">\"/users/:id\"</span>, userController.<span class=\"hljs-property\">getUserById</span>);\nrouter.<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-string\">\"/users\"</span>, userController.<span class=\"hljs-property\">createUser</span>);\nrouter.<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-string\">\"/users/:id\"</span>, userController.<span class=\"hljs-property\">updateUser</span>);\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> router;\n</code></pre>","children":[],"payload":{"lines":"92,109"}}],"payload":{"lines":"85,109"}}],"payload":{"lines":"84,109"}}],"payload":{"lines":"83,84"}},{"content":"4. Middleware de Manejo de Errores","children":[{"content":"<strong>Middleware de Manejo de Errores</strong>","children":[{"content":"\n<p data-lines=\"111,112\">Captura y maneja errores no manejados por las rutas.</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> { globalErrorHandler } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./utils/errorHandler\"</span>;\napp.<span class=\"hljs-title function_\">use</span>(globalErrorHandler);\n</code></pre>","children":[{"content":"\n<p data-lines=\"118,119\"><strong>Ejemplo de <code>globalErrorHandler</code>:</strong></p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Request</span>, <span class=\"hljs-title class_\">Response</span>, <span class=\"hljs-title class_\">NextFunction</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"express\"</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">globalErrorHandler</span>(<span class=\"hljs-params\">\n  err: <span class=\"hljs-built_in\">Error</span>,\n  req: Request,\n  res: Response,\n  next: NextFunction\n</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(err.<span class=\"hljs-property\">stack</span>);\n  res.<span class=\"hljs-title function_\">status</span>(<span class=\"hljs-number\">500</span>).<span class=\"hljs-title function_\">json</span>({\n    <span class=\"hljs-attr\">success</span>: <span class=\"hljs-literal\">false</span>,\n    <span class=\"hljs-attr\">message</span>: err.<span class=\"hljs-property\">message</span> || <span class=\"hljs-string\">\"Internal Server Error\"</span>,\n  });\n}\n</code></pre>","children":[],"payload":{"lines":"118,137"}}],"payload":{"lines":"111,137"}}],"payload":{"lines":"110,137"}}],"payload":{"lines":"109,110"}},{"content":"5. Middleware de Registro (opcional)","children":[{"content":"<strong>Middleware de Registro</strong>","children":[{"content":"\n<p data-lines=\"139,140\">Registra solicitudes, respuestas y errores para depuración y monitoreo.</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> morgan <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"morgan\"</span>;\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">morgan</span>(<span class=\"hljs-string\">'combined'</span>));\n</code></pre>","children":[],"payload":{"lines":"139,146"}}],"payload":{"lines":"138,146"}}],"payload":{"lines":"137,138"}},{"content":"6. Configuración de la Base de Datos","children":[{"content":"<strong>Inicialización de la Base de Datos</strong>","children":[{"content":"\n<p data-lines=\"148,149\">Conecta con la base de datos y maneja errores.</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> dataSource <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./config/ormconfig\"</span>;\n\ndataSource\n  .<span class=\"hljs-title function_\">initialize</span>()\n  .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">\"Connected to the database!\"</span>);\n    app.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-variable constant_\">PORT</span>, <span class=\"hljs-function\">() =&gt;</span> {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`Server running at PORT: <span class=\"hljs-subst\">${PORT}</span>`</span>);\n    });\n  })\n  .<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">error</span>) =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(<span class=\"hljs-string\">\"Error connecting to the database:\"</span>, error);\n  });\n</code></pre>","children":[],"payload":{"lines":"148,166"}}],"payload":{"lines":"147,166"}}],"payload":{"lines":"146,147"}},{"content":"7. Configuración Adicional","children":[{"content":"\n<p data-lines=\"167,168\"><strong>Middleware de Caching (opcional)</strong></p>","children":[{"content":"Implementa caché para resultados de consultas frecuentes.","children":[],"payload":{"lines":"168,170"}}],"payload":{"lines":"167,170"}},{"content":"\n<p data-lines=\"170,171\"><strong>Middleware de Seguridad Adicional (opcional)</strong></p>","children":[{"content":"Restricciones de IP, autenticación de solicitudes, etc.","children":[],"payload":{"lines":"171,173"}}],"payload":{"lines":"170,173"}}],"payload":{"lines":"166,167"}},{"content":"Ejemplo Completo","children":[{"content":"<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> express <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"express\"</span>;\n<span class=\"hljs-keyword\">import</span> cors <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"cors\"</span>;\n<span class=\"hljs-keyword\">import</span> bodyParser <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"body-parser\"</span>;\n<span class=\"hljs-keyword\">import</span> helmet <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"helmet\"</span>;\n<span class=\"hljs-keyword\">import</span> compression <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"compression\"</span>;\n<span class=\"hljs-keyword\">import</span> morgan <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"morgan\"</span>;\n<span class=\"hljs-keyword\">import</span> dotenv <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"dotenv\"</span>;\n<span class=\"hljs-keyword\">import</span> dataSource <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./config/ormconfig\"</span>;\n<span class=\"hljs-keyword\">import</span> { globalErrorHandler } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./utils/errorHandler\"</span>;\n<span class=\"hljs-keyword\">import</span> routes <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./routes\"</span>;\n<span class=\"hljs-keyword\">import</span> { responseMiddleware } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./utils/responseMiddleware\"</span>;\n\ndotenv.<span class=\"hljs-title function_\">config</span>();\n\n<span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">express</span>();\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">PORT</span> = process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">APP_PORT</span> || <span class=\"hljs-number\">3000</span>;\n\n<span class=\"hljs-comment\">// Configuración de middlewares generales</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">helmet</span>()); <span class=\"hljs-comment\">// Seguridad</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">compression</span>()); <span class=\"hljs-comment\">// Compresión</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">cors</span>()); <span class=\"hljs-comment\">// CORS</span>\napp.<span class=\"hljs-title function_\">use</span>(bodyParser.<span class=\"hljs-title function_\">json</span>()); <span class=\"hljs-comment\">// Análisis JSON</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">morgan</span>(<span class=\"hljs-string\">'combined'</span>)); <span class=\"hljs-comment\">// Registro de solicitudes</span>\n\n<span class=\"hljs-comment\">// Middleware de respuesta personalizado</span>\napp.<span class=\"hljs-title function_\">use</span>(responseMiddleware);\n\n<span class=\"hljs-comment\">// Definición de rutas</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">\"/api/\"</span>, routes);\n\n<span class=\"hljs-comment\">// Middleware de manejo de errores</span>\napp.<span class=\"hljs-title function_\">use</span>(globalErrorHandler);\n\n<span class=\"hljs-comment\">// Inicialización de la base de datos y inicio del servidor</span>\ndataSource\n  .<span class=\"hljs-title function_\">initialize</span>()\n  .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">\"Connected to the database!\"</span>);\n    app.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-variable constant_\">PORT</span>, <span class=\"hljs-function\">() =&gt;</span> {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`Server running at PORT: <span class=\"hljs-subst\">${PORT}</span>`</span>);\n    });\n  })\n  .<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">error</span>) =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(<span class=\"hljs-string\">\"Error connecting to the database:\"</span>, error);\n  });\n</code></pre>","children":[]}],"payload":{"lines":"173,174"}}],"payload":{"lines":"0,1"}},null)</script>
</body>
</html>
