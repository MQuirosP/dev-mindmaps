<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
html {
  font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
.markmap-dark {
  background: #27272a;
  color: white;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.12/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/index.js"></script><script>(()=>{setTimeout(()=>{const{markmap:S,mm:Q}=window,$=new S.Toolbar;$.attach(Q);const I=$.render();I.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(I)})})()</script><script>((l,U,M,R)=>{const N=l();window.mm=N.Markmap.create("svg#mindmap",(U||N.deriveOptions)(R),M),window.matchMedia("(prefers-color-scheme: dark)").matches&&document.documentElement.classList.add("markmap-dark")})(()=>window.markmap,null,{"content":"&#x1f9e0; Patrones aplicados en backend trazable","children":[{"content":"&#x1f9e9; Patrones de dise&#xf1;o (nivel c&#xf3;digo)","children":[{"content":"Object Literal Pattern","children":[{"content":"Usado en AuthController, AuthService, UserRepository","children":[],"payload":{"tag":"li","lines":"5,6"}},{"content":"Agrupa funciones puras en un objeto plano","children":[],"payload":{"tag":"li","lines":"6,7"}},{"content":"Evita clases innecesarias","children":[],"payload":{"tag":"li","lines":"7,8"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"9,16\"><code class=\"language-ts\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">AuthService</span> = {\n  <span class=\"hljs-attr\">hashPassword</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\"><span class=\"hljs-attr\">plain</span>: <span class=\"hljs-built_in\">string</span></span>) =&gt;</span> bcrypt.<span class=\"hljs-title function_\">hash</span>(plain, <span class=\"hljs-number\">10</span>),\n  <span class=\"hljs-attr\">validatePassword</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\"><span class=\"hljs-attr\">plain</span>: <span class=\"hljs-built_in\">string</span>, <span class=\"hljs-attr\">hash</span>: <span class=\"hljs-built_in\">string</span></span>) =&gt;</span> bcrypt.<span class=\"hljs-title function_\">compare</span>(plain, hash),\n  <span class=\"hljs-attr\">generateToken</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\"><span class=\"hljs-attr\">userId</span>: <span class=\"hljs-built_in\">string</span></span>) =&gt;</span> jwt.<span class=\"hljs-title function_\">sign</span>({ userId }, process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">JWT_SECRET</span>!)\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"8,17"}}],"payload":{"tag":"h3","lines":"4,5"}},{"content":"Factory Pattern","children":[{"content":"Usado en OCRFactory","children":[],"payload":{"tag":"li","lines":"18,19"}},{"content":"Crea instancias seg&#xfa;n par&#xe1;metro","children":[],"payload":{"tag":"li","lines":"19,20"}},{"content":"Desacopla l&#xf3;gica de selecci&#xf3;n","children":[],"payload":{"tag":"li","lines":"20,21"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"22,29\"><code class=\"language-ts\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">OCRFactory</span> = (<span class=\"hljs-params\"><span class=\"hljs-attr\">provider</span>: <span class=\"hljs-string\">&quot;gcv&quot;</span> | <span class=\"hljs-string\">&quot;tesseract&quot;</span></span>) =&gt; {\n  <span class=\"hljs-keyword\">if</span> (provider === <span class=\"hljs-string\">&quot;gcv&quot;</span>) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">GoogleCloudVisionOCR</span>\n  <span class=\"hljs-keyword\">if</span> (provider === <span class=\"hljs-string\">&quot;tesseract&quot;</span>) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">TesseractOCR</span>\n  <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">&quot;Unsupported OCR provider&quot;</span>)\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"21,30"}}],"payload":{"tag":"h3","lines":"17,18"}},{"content":"Strategy Pattern","children":[{"content":"Impl&#xed;cito en OCR: GoogleCloudVision, TesseractOCR","children":[],"payload":{"tag":"li","lines":"31,32"}},{"content":"Cada proveedor implementa su estrategia","children":[],"payload":{"tag":"li","lines":"32,33"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"34,47\"><code class=\"language-ts\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title class_\">OCRStrategy</span> {\n  <span class=\"hljs-title function_\">extractText</span>(<span class=\"hljs-attr\">filePath</span>: <span class=\"hljs-built_in\">string</span>): <span class=\"hljs-title class_\">Promise</span>&lt;<span class=\"hljs-built_in\">string</span>&gt;\n}\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">GoogleCloudVision</span>: <span class=\"hljs-title class_\">OCRStrategy</span> = {\n  <span class=\"hljs-attr\">extractText</span>: <span class=\"hljs-title function_\">async</span> (filePath) =&gt; { <span class=\"hljs-comment\">/* implementaci&#xf3;n */</span> }\n}\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">TesseractOCR</span>: <span class=\"hljs-title class_\">OCRStrategy</span> = {\n  <span class=\"hljs-attr\">extractText</span>: <span class=\"hljs-title function_\">async</span> (filePath) =&gt; { <span class=\"hljs-comment\">/* implementaci&#xf3;n */</span> }\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"33,48"}}],"payload":{"tag":"h3","lines":"30,31"}},{"content":"Repository Pattern","children":[{"content":"Migrado de clase a objeto plano","children":[],"payload":{"tag":"li","lines":"49,50"}},{"content":"Encapsula acceso a datos","children":[],"payload":{"tag":"li","lines":"50,51"}},{"content":"Compatible con Prisma","children":[],"payload":{"tag":"li","lines":"51,52"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"53,59\"><code class=\"language-ts\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">UserRepository</span> = {\n  <span class=\"hljs-attr\">findByEmail</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\"><span class=\"hljs-attr\">email</span>: <span class=\"hljs-built_in\">string</span></span>) =&gt;</span> prisma.<span class=\"hljs-property\">user</span>.<span class=\"hljs-title function_\">findUnique</span>({ <span class=\"hljs-attr\">where</span>: { email } }),\n  <span class=\"hljs-attr\">create</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\"><span class=\"hljs-attr\">data</span>: <span class=\"hljs-title class_\">Prisma</span>.<span class=\"hljs-title class_\">UserCreateInput</span></span>) =&gt;</span> prisma.<span class=\"hljs-property\">user</span>.<span class=\"hljs-title function_\">create</span>({ data })\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"52,60"}}],"payload":{"tag":"h3","lines":"48,49"}},{"content":"Service Layer Pattern","children":[{"content":"L&#xf3;gica de negocio en AuthService, etc.","children":[],"payload":{"tag":"li","lines":"61,62"}},{"content":"Evita ensuciar el controlador","children":[],"payload":{"tag":"li","lines":"62,63"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"64,73\"><code class=\"language-ts\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">InvoiceService</span> = {\n  <span class=\"hljs-attr\">createWithFiles</span>: <span class=\"hljs-title function_\">async</span> (data, userId, files) =&gt; {\n    <span class=\"hljs-keyword\">const</span> invoice = <span class=\"hljs-keyword\">await</span> prisma.<span class=\"hljs-property\">invoice</span>.<span class=\"hljs-title function_\">create</span>({ <span class=\"hljs-attr\">data</span>: { ...data, userId } })\n    <span class=\"hljs-keyword\">if</span> (files) { <span class=\"hljs-comment\">/* l&#xf3;gica de archivos */</span> }\n    <span class=\"hljs-keyword\">return</span> invoice\n  }\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"63,74"}}],"payload":{"tag":"h3","lines":"60,61"}},{"content":"Controller Layer Pattern","children":[{"content":"Orquesta flujo HTTP","children":[],"payload":{"tag":"li","lines":"75,76"}},{"content":"Logging, validaci&#xf3;n, respuesta","children":[],"payload":{"tag":"li","lines":"76,77"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"78,86\"><code class=\"language-ts\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">AuthController</span> = {\n  <span class=\"hljs-attr\">login</span>: <span class=\"hljs-title function_\">async</span> (<span class=\"hljs-attr\">req</span>: <span class=\"hljs-title class_\">Request</span>, <span class=\"hljs-attr\">res</span>: <span class=\"hljs-title class_\">Response</span>) =&gt; {\n    <span class=\"hljs-keyword\">const</span> user = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title class_\">AuthService</span>.<span class=\"hljs-title function_\">validateLogin</span>(req.<span class=\"hljs-property\">body</span>)\n    res.<span class=\"hljs-title function_\">json</span>({ <span class=\"hljs-attr\">token</span>: <span class=\"hljs-title class_\">AuthService</span>.<span class=\"hljs-title function_\">generateToken</span>(user.<span class=\"hljs-property\">id</span>) })\n  }\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"77,87"}}],"payload":{"tag":"h3","lines":"74,75"}},{"content":"Middleware Pattern","children":[{"content":"Validaci&#xf3;n MIME, JWT, etc.","children":[],"payload":{"tag":"li","lines":"88,89"}},{"content":"Composici&#xf3;n clara sin acoplamiento","children":[],"payload":{"tag":"li","lines":"89,90"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"91,103\"><code class=\"language-ts\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">jwtMiddleware</span> = (<span class=\"hljs-params\">req, res, next</span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> token = req.<span class=\"hljs-property\">headers</span>.<span class=\"hljs-property\">authorization</span>?.<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-string\">&quot; &quot;</span>)[<span class=\"hljs-number\">1</span>]\n  <span class=\"hljs-keyword\">if</span> (!token) <span class=\"hljs-keyword\">return</span> res.<span class=\"hljs-title function_\">status</span>(<span class=\"hljs-number\">401</span>).<span class=\"hljs-title function_\">json</span>({ <span class=\"hljs-attr\">error</span>: <span class=\"hljs-string\">&quot;Unauthorized&quot;</span> })\n  <span class=\"hljs-keyword\">try</span> {\n    req.<span class=\"hljs-property\">user</span> = jwt.<span class=\"hljs-title function_\">verify</span>(token, process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">JWT_SECRET</span>!)\n    <span class=\"hljs-title function_\">next</span>()\n  } <span class=\"hljs-keyword\">catch</span> {\n    res.<span class=\"hljs-title function_\">status</span>(<span class=\"hljs-number\">401</span>).<span class=\"hljs-title function_\">json</span>({ <span class=\"hljs-attr\">error</span>: <span class=\"hljs-string\">&quot;Invalid token&quot;</span> })\n  }\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"90,104"}}],"payload":{"tag":"h3","lines":"87,88"}}],"payload":{"tag":"h2","lines":"2,3"}},{"content":"&#x1f3d7;&#xfe0f; Patrones de arquitectura (nivel sistema)","children":[{"content":"Modular Monolith","children":[{"content":"<code>modules/</code>, <code>shared/</code>, <code>config/</code>","children":[],"payload":{"tag":"li","lines":"109,110"}},{"content":"Dominio separado, misma app","children":[],"payload":{"tag":"li","lines":"110,111"}},{"content":"Escalable sin microservicios","children":[],"payload":{"tag":"li","lines":"111,112"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"113,123\"><code data-lines=\"113,123\"><span class=\"hljs-attribute\">src</span>/\n  modules/\n    auth/\n    invoices/\n  shared/\n    logger/\n  config/\n    db<span class=\"hljs-selector-class\">.ts</span>\n</code></pre>","children":[],"payload":{"tag":"li","lines":"112,124"}}],"payload":{"tag":"h3","lines":"108,109"}},{"content":"Hexagonal Architecture","children":[{"content":"Servicios puros, repositorios desacoplados","children":[],"payload":{"tag":"li","lines":"125,126"}},{"content":"Dominio independiente de Express, Prisma","children":[],"payload":{"tag":"li","lines":"126,127"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"128,133\"><code data-lines=\"128,133\">domain<span class=\"hljs-operator\">/</span>InvoiceService.ts      <span class=\"hljs-operator\">&lt;-</span> l&#xf3;gica pura\ninfrastructure<span class=\"hljs-operator\">/</span>InvoiceRepo.ts <span class=\"hljs-operator\">&lt;-</span> prisma\nadapters<span class=\"hljs-operator\">/</span>http<span class=\"hljs-operator\">/</span>InvoiceCtrl.ts  <span class=\"hljs-operator\">&lt;-</span> Express\n</code></pre>","children":[],"payload":{"tag":"li","lines":"127,134"}}],"payload":{"tag":"h3","lines":"124,125"}},{"content":"Clean Architecture","children":[{"content":"Capas expl&#xed;citas: Controller, Service, Repository","children":[],"payload":{"tag":"li","lines":"135,136"}},{"content":"Compatible con trazabilidad y contratos","children":[],"payload":{"tag":"li","lines":"136,137"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"138,143\"><code data-lines=\"138,143\">controllers <span class=\"hljs-punctuation\">-&gt;</span> reciben HTTP\nservices    <span class=\"hljs-punctuation\">-&gt;</span> aplican reglas de negocio\nrepositories<span class=\"hljs-punctuation\">-&gt;</span> abstraen base de datos\n</code></pre>","children":[],"payload":{"tag":"li","lines":"137,144"}}],"payload":{"tag":"h3","lines":"134,135"}},{"content":"CQRS","children":[{"content":"Separaci&#xf3;n de comandos y queries","children":[],"payload":{"tag":"li","lines":"145,146"}},{"content":"&#xda;til para optimizar lectura vs escritura","children":[],"payload":{"tag":"li","lines":"146,147"}},{"content":"<strong>Ejemplo:</strong><pre data-lines=\"148,158\"><code class=\"language-ts\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">InvoiceQueries</span> = {\n  <span class=\"hljs-attr\">findByUser</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\"><span class=\"hljs-attr\">userId</span>: <span class=\"hljs-built_in\">string</span></span>) =&gt;</span> prisma.<span class=\"hljs-property\">invoice</span>.<span class=\"hljs-title function_\">findMany</span>({ <span class=\"hljs-attr\">where</span>: { userId } })\n}\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">InvoiceCommands</span> = {\n  <span class=\"hljs-attr\">create</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">data</span>) =&gt;</span> prisma.<span class=\"hljs-property\">invoice</span>.<span class=\"hljs-title function_\">create</span>({ data }),\n  <span class=\"hljs-attr\">delete</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\"><span class=\"hljs-attr\">id</span>: <span class=\"hljs-built_in\">string</span></span>) =&gt;</span> prisma.<span class=\"hljs-property\">invoice</span>.<span class=\"hljs-title function_\">delete</span>({ <span class=\"hljs-attr\">where</span>: { id } })\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"147,159"}}],"payload":{"tag":"h3","lines":"144,145"}}],"payload":{"tag":"h2","lines":"106,107"}},{"content":"&#x274c; Patrones evitados","children":[{"content":"Class-based Services","children":[{"content":"Eliminados por ruido y defensividad","children":[],"payload":{"tag":"li","lines":"164,165"}},{"content":"<strong>Anti-ejemplo:</strong><pre data-lines=\"166,172\"><code class=\"language-ts\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">AuthService</span> {\n  <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">private</span> <span class=\"hljs-attr\">prisma</span>: <span class=\"hljs-title class_\">PrismaClient</span></span>) {}\n  <span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">login</span>(<span class=\"hljs-params\"></span>) { <span class=\"hljs-comment\">/* innecesario */</span> }\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"165,173"}}],"payload":{"tag":"h3","lines":"163,164"}},{"content":"Helper Pattern","children":[{"content":"Rechazado por dispersi&#xf3;n y falta de sem&#xe1;ntica","children":[],"payload":{"tag":"li","lines":"174,175"}},{"content":"<strong>Anti-ejemplo:</strong><pre data-lines=\"176,181\"><code class=\"language-ts\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">Utils</span> = {\n  <span class=\"hljs-attr\">doStuff</span>: <span class=\"hljs-function\">() =&gt;</span> { <span class=\"hljs-comment\">/* sin contexto */</span> }\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"175,182"}}],"payload":{"tag":"h3","lines":"173,174"}},{"content":"Overmodularization","children":[{"content":"Combatido con consolidaci&#xf3;n quir&#xfa;rgica","children":[],"payload":{"tag":"li","lines":"183,184"}},{"content":"<strong>Anti-ejemplo:</strong><pre data-lines=\"185,196\"><code data-lines=\"185,196\">src/\n  auth/\n    login/\n      index.ts\n      dto.ts\n      validator.ts\n    <span class=\"hljs-built_in\">logout</span>/\n      index.ts\n// excesiva fragmentaci&#xf3;n\n</code></pre>","children":[],"payload":{"tag":"li","lines":"184,196"}}],"payload":{"tag":"h3","lines":"182,183"}}],"payload":{"tag":"h2","lines":"161,162"}}],"payload":{"tag":"h1","lines":"0,1"}},null)</script>
</body>
</html>
