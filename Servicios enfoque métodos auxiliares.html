<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.3-alpha.1/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.3-alpha.1/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.3-alpha.1/dist/index.js"></script><script>(()=>{setTimeout(()=>{const{markmap:q,mm:v}=window,j=new q.Toolbar;j.attach(v);const we=j.render();we.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(we)})})()</script><script>((f,d,h,u)=>{const g=f();window.mm=g.Markmap.create("svg#mindmap",(d||g.deriveOptions)(u),h)})(()=>window.markmap,null,{"content":"Modularización y Refactorización de Servicios en TypeScript","children":[{"content":"CustomerService Refactorizado","children":[{"content":"Métodos del Servicio","children":[{"content":"<code>createCustomer</code>: Crear nuevo cliente","children":[],"payload":{"lines":"3,4"}},{"content":"<code>fetchAllCustomers</code>: Obtener todos los clientes","children":[],"payload":{"lines":"4,5"}},{"content":"<code>getCustomerByPK</code>: Buscar cliente por ID","children":[],"payload":{"lines":"5,6"}},{"content":"<code>getCustomerByName</code>: Buscar cliente por nombre","children":[],"payload":{"lines":"6,7"}},{"content":"<code>updateCustomer</code>: Actualizar datos del cliente","children":[],"payload":{"lines":"7,8"}},{"content":"<code>deleteCustomer</code>: Eliminar cliente","children":[],"payload":{"lines":"8,9"}},{"content":"<strong>Patrones aplicados</strong>:","children":[{"content":"Modularización","children":[],"payload":{"lines":"10,11"}},{"content":"DRY (Don't Repeat Yourself)","children":[],"payload":{"lines":"11,12"}},{"content":"Abstracción y separación de responsabilidades","children":[],"payload":{"lines":"12,14"}}],"payload":{"lines":"9,14"}}],"payload":{"lines":"2,14"}}],"payload":{"lines":"1,2"}},{"content":"Funciones Auxiliares","children":[{"content":"<code>handleDatabaseOperation</code>","children":[{"content":"Maneja la ejecución de operaciones de base de datos y errores","children":[],"payload":{"lines":"16,17"}},{"content":"Evita duplicación de bloques <code>try-catch</code>","children":[],"payload":{"lines":"17,18"}},{"content":"<strong>Concepto</strong>: Función de orden superior","children":[],"payload":{"lines":"18,19"}}],"payload":{"lines":"15,19"}},{"content":"<code>findCustomerById</code>","children":[{"content":"Busca un cliente por su ID y valida su existencia","children":[],"payload":{"lines":"20,21"}},{"content":"Reduce repetición de lógica en métodos como <code>updateCustomer</code> y <code>deleteCustomer</code>","children":[],"payload":{"lines":"21,22"}},{"content":"<strong>Concepto</strong>: Abstracción y reutilización de código","children":[],"payload":{"lines":"22,24"}}],"payload":{"lines":"19,24"}}],"payload":{"lines":"14,15"}},{"content":"Principios de Diseño Aplicados","children":[{"content":"<strong>Modularización</strong>","children":[{"content":"Dividir lógica en partes manejables y reutilizables","children":[],"payload":{"lines":"26,27"}},{"content":"Crear funciones auxiliares para tareas repetitivas","children":[],"payload":{"lines":"27,28"}}],"payload":{"lines":"25,28"}},{"content":"<strong>DRY (Don't Repeat Yourself)</strong>","children":[{"content":"Centralizar lógica de manejo de errores","children":[],"payload":{"lines":"29,30"}},{"content":"Reducir duplicación de código","children":[],"payload":{"lines":"30,31"}}],"payload":{"lines":"28,31"}},{"content":"<strong>Abstracción</strong>","children":[{"content":"Ocultar detalles de implementación","children":[],"payload":{"lines":"32,33"}},{"content":"Simplificar la lógica principal del servicio","children":[],"payload":{"lines":"33,34"}}],"payload":{"lines":"31,34"}},{"content":"<strong>Separación de Responsabilidades (SoC)</strong>","children":[{"content":"Métodos especializados para tareas específicas","children":[],"payload":{"lines":"35,36"}},{"content":"Claridad y mantenibilidad del código","children":[],"payload":{"lines":"36,38"}}],"payload":{"lines":"34,38"}}],"payload":{"lines":"24,25"}},{"content":"Tipos de Funciones","children":[{"content":"<strong>Funciones Flecha (Arrow Functions)</strong>","children":[{"content":"Sintaxis: <code>() =&gt; { ... }</code>","children":[],"payload":{"lines":"40,41"}},{"content":"Beneficio: No tienen su propio contexto (<code>this</code>)","children":[],"payload":{"lines":"41,42"}},{"content":"Uso: Fácil integración en funciones de orden superior","children":[],"payload":{"lines":"42,43"}}],"payload":{"lines":"39,43"}},{"content":"<strong>Funciones Anónimas Asincrónicas</strong>","children":[{"content":"Sintaxis: <code>async () =&gt; { ... }</code>","children":[],"payload":{"lines":"44,45"}},{"content":"Uso en: <code>handleDatabaseOperation</code>","children":[],"payload":{"lines":"45,46"}},{"content":"Beneficio: Ejecutar operaciones asincrónicas sin nombrar la función","children":[],"payload":{"lines":"46,47"}},{"content":"<strong>Ejemplo</strong>:<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">fetchAllCustomers</span>(): <span class=\"hljs-title class_\">Promise</span>&lt;<span class=\"hljs-title class_\">Customer</span>[]&gt; {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">handleDatabaseOperation</span>(<span class=\"hljs-title function_\">async</span> () =&gt; {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">customerRepository</span>.<span class=\"hljs-title function_\">find</span>();\n  });\n}\n</code></pre>","children":[],"payload":{"lines":"47,56"}}],"payload":{"lines":"43,56"}}],"payload":{"lines":"38,39"}},{"content":"Código Refactorizado: Ejemplo Completo","children":[{"content":"Servicio Refactorizado<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CustomerService</span> {\n  <span class=\"hljs-keyword\">private</span> <span class=\"hljs-attr\">customerRepository</span>: <span class=\"hljs-title class_\">Repository</span>&lt;<span class=\"hljs-title class_\">Customer</span>&gt;;\n\n  <span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\"><span class=\"hljs-attr\">customerRepository</span>: <span class=\"hljs-title class_\">Repository</span>&lt;<span class=\"hljs-title class_\">Customer</span>&gt;</span>) {\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">customerRepository</span> = customerRepository;\n  }\n\n  <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">async</span> handleDatabaseOperation&lt;T&gt;(<span class=\"hljs-attr\">operation</span>: <span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title class_\">Promise</span>&lt;T&gt;): <span class=\"hljs-title class_\">Promise</span>&lt;T&gt; {\n    <span class=\"hljs-keyword\">try</span> {\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">operation</span>();\n    } <span class=\"hljs-keyword\">catch</span> (error) {\n      <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-title function_\">handleDatabaseError</span>(error);\n    }\n  }\n\n  <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">findCustomerById</span>(<span class=\"hljs-attr\">customerId</span>: <span class=\"hljs-built_in\">number</span>): <span class=\"hljs-title class_\">Promise</span>&lt;<span class=\"hljs-title class_\">Customer</span>&gt; {\n    <span class=\"hljs-keyword\">const</span> customer = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">customerRepository</span>.<span class=\"hljs-title function_\">findOne</span>({\n      <span class=\"hljs-attr\">where</span>: { <span class=\"hljs-attr\">customer_id</span>: customerId },\n    });\n    <span class=\"hljs-keyword\">if</span> (!customer) <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">AppError</span>(<span class=\"hljs-string\">\"Customer not found.\"</span>, <span class=\"hljs-number\">404</span>);\n    <span class=\"hljs-keyword\">return</span> customer;\n  }\n\n  <span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">createCustomer</span>(<span class=\"hljs-attr\">customerData</span>: <span class=\"hljs-title class_\">Partial</span>&lt;<span class=\"hljs-title class_\">Customer</span>&gt;): <span class=\"hljs-title class_\">Promise</span>&lt;<span class=\"hljs-title class_\">Customer</span>&gt; {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">handleDatabaseOperation</span>(<span class=\"hljs-title function_\">async</span> () =&gt; {\n      <span class=\"hljs-keyword\">const</span> newCustomer = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">customerRepository</span>.<span class=\"hljs-title function_\">create</span>(customerData);\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">customerRepository</span>.<span class=\"hljs-title function_\">save</span>(newCustomer);\n    });\n  }\n\n  <span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">fetchAllCustomers</span>(): <span class=\"hljs-title class_\">Promise</span>&lt;<span class=\"hljs-title class_\">Customer</span>[]&gt; {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">handleDatabaseOperation</span>(<span class=\"hljs-title function_\">async</span> () =&gt; {\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">customerRepository</span>.<span class=\"hljs-title function_\">find</span>();\n    });\n  }\n\n  <span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">getCustomerByPK</span>(<span class=\"hljs-attr\">customerId</span>: <span class=\"hljs-built_in\">number</span>): <span class=\"hljs-title class_\">Promise</span>&lt;<span class=\"hljs-title class_\">Customer</span>&gt; {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">handleDatabaseOperation</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">findCustomerById</span>(customerId));\n  }\n\n  <span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">getCustomerByName</span>(<span class=\"hljs-attr\">customerName</span>: <span class=\"hljs-built_in\">string</span>): <span class=\"hljs-title class_\">Promise</span>&lt;<span class=\"hljs-title class_\">Customer</span>[]&gt; {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">handleDatabaseOperation</span>(<span class=\"hljs-title function_\">async</span> () =&gt; {\n      <span class=\"hljs-keyword\">const</span> customers = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">customerRepository</span>.<span class=\"hljs-title function_\">find</span>({\n        <span class=\"hljs-attr\">where</span>: {\n          <span class=\"hljs-attr\">customer_name</span>: <span class=\"hljs-title class_\">ILike</span>(<span class=\"hljs-string\">`%<span class=\"hljs-subst\">${customerName}</span>%`</span>),\n        },\n      });\n      <span class=\"hljs-keyword\">return</span> customers;\n    });\n  }\n\n  <span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">updateCustomer</span>(\n    <span class=\"hljs-attr\">customerId</span>: <span class=\"hljs-built_in\">number</span>,\n    <span class=\"hljs-attr\">updates</span>: <span class=\"hljs-title class_\">Partial</span>&lt;<span class=\"hljs-title class_\">Customer</span>&gt;\n  ): <span class=\"hljs-title class_\">Promise</span>&lt;<span class=\"hljs-title class_\">Customer</span>&gt; {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">handleDatabaseOperation</span>(<span class=\"hljs-title function_\">async</span> () =&gt; {\n      <span class=\"hljs-keyword\">const</span> customer = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">findCustomerById</span>(customerId);\n      <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">assign</span>(customer, updates);\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">customerRepository</span>.<span class=\"hljs-title function_\">save</span>(customer);\n    });\n  }\n\n  <span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">deleteCustomer</span>(<span class=\"hljs-attr\">customerId</span>: <span class=\"hljs-built_in\">number</span>): <span class=\"hljs-title class_\">Promise</span>&lt;<span class=\"hljs-built_in\">void</span>&gt; {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">handleDatabaseOperation</span>(<span class=\"hljs-title function_\">async</span> () =&gt; {\n      <span class=\"hljs-keyword\">const</span> customer = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">findCustomerById</span>(customerId);\n      <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">customerRepository</span>.<span class=\"hljs-title function_\">delete</span>(customer.<span class=\"hljs-property\">customer_id</span>);\n    });\n  }\n}\n</code></pre>","children":[],"payload":{"lines":"57,128"}}],"payload":{"lines":"56,57"}}],"payload":{"lines":"0,1"}},null)</script>
</body>
</html>
