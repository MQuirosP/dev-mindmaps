<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.0/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.0/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.0/dist/index.js"></script><script>(()=>{setTimeout(()=>{const{markmap:q,mm:v}=window,j=new q.Toolbar;j.attach(v);const we=j.render();we.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(we)})})()</script><script>((f,d,h,u)=>{const g=f();window.mm=g.Markmap.create("svg#mindmap",(d||g.deriveOptions)(u),h)})(()=>window.markmap,null,{"content":"Orden en la Configuración de Express","children":[{"content":"1. Configuración General","children":[{"content":"<strong>Importaciones y Configuración Inicial</strong>","children":[{"content":"\n<p data-lines=\"4,5\">Importa módulos y configura el entorno al inicio del archivo.</p>\n<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> express <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"express\"</span>;\n<span class=\"hljs-keyword\">import</span> cors <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"cors\"</span>;\n<span class=\"hljs-keyword\">import</span> bodyParser <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"body-parser\"</span>;\n<span class=\"hljs-keyword\">import</span> helmet <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"helmet\"</span>;\n<span class=\"hljs-keyword\">import</span> compression <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"compression\"</span>;\n<span class=\"hljs-keyword\">import</span> morgan <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"morgan\"</span>;\n<span class=\"hljs-keyword\">import</span> dotenv <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"dotenv\"</span>;\n<span class=\"hljs-keyword\">import</span> dataSource <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./config/ormconfig\"</span>;\n<span class=\"hljs-keyword\">import</span> { globalErrorHandler } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./utils/errorHandler\"</span>;\n<span class=\"hljs-keyword\">import</span> routes <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./routes\"</span>;\n<span class=\"hljs-keyword\">import</span> { responseMiddleware } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./utils/responseMiddleware\"</span>;\n</code></pre>","children":[],"payload":{"lines":"4,20"}}],"payload":{"lines":"3,20"}}],"payload":{"lines":"2,3"}},{"content":"2. Configuración de Middleware","children":[{"content":"<strong>Orden de Middleware Importante</strong>","children":[{"content":"\n<p data-lines=\"22,23\"><strong>Middleware de Seguridad y Rendimiento (antes de <code>cors</code> y <code>bodyParser</code>):</strong></p>","children":[{"content":"<strong><code>helmet</code></strong>: Añade cabeceras de seguridad.","children":[],"payload":{"lines":"23,24"}},{"content":"<strong><code>compression</code></strong>: Comprime respuestas para mejorar el rendimiento.","children":[],"payload":{"lines":"24,26"}}],"payload":{"lines":"22,31"}},{"content":"\n<p data-lines=\"31,32\"><strong>Middleware de <code>cors</code> (después de seguridad y rendimiento):</strong></p>","children":[{"content":"Permite solicitudes de diferentes orígenes.","children":[],"payload":{"lines":"32,34"}}],"payload":{"lines":"31,38"}},{"content":"\n<p data-lines=\"38,39\"><strong>Middleware de <code>bodyParser</code> (después de <code>cors</code>):</strong></p>","children":[{"content":"Analiza cuerpos de solicitud JSON.","children":[],"payload":{"lines":"39,41"}}],"payload":{"lines":"38,45"}},{"content":"\n<p data-lines=\"45,46\"><strong>Middleware de Registro (opcional, puede ir después de <code>bodyParser</code>):</strong></p>","children":[{"content":"<strong><code>morgan</code></strong>: Registra solicitudes HTTP para depuración.","children":[],"payload":{"lines":"46,48"}}],"payload":{"lines":"45,52"}}],"payload":{"lines":"21,52"}}],"payload":{"lines":"20,21"}},{"content":"3. Middleware Personalizado","children":[{"content":"<strong>Middleware de Respuesta Personalizado</strong>","children":[{"content":"\n<p data-lines=\"54,55\">Define métodos personalizados (<code>success</code>, <code>error</code>) en el objeto de respuesta.</p>","children":[],"payload":{"lines":"54,55"}},{"content":"\n<p data-lines=\"55,56\">Debe ir <strong>antes de las rutas</strong> para asegurar que los métodos estén disponibles para todas las rutas.</p>\n<pre><code class=\"language-typescript\">app.use(responseMiddleware);\n</code></pre>","children":[],"payload":{"lines":"55,61"}}],"payload":{"lines":"53,61"}}],"payload":{"lines":"52,53"}},{"content":"4. Rutas de la Aplicación","children":[{"content":"<strong>Definición de Rutas</strong>","children":[{"content":"\n<p data-lines=\"63,64\">Define las rutas de la aplicación después de los middlewares generales y personalizados.</p>","children":[],"payload":{"lines":"63,64"}},{"content":"\n<p data-lines=\"64,65\">Asegura que todas las rutas utilicen la configuración y los middlewares definidos anteriormente.</p>\n<pre><code class=\"language-typescript\">app.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">\"/api/\"</span>, routes);\n</code></pre>","children":[],"payload":{"lines":"64,70"}}],"payload":{"lines":"62,70"}}],"payload":{"lines":"61,62"}},{"content":"5. Manejo de Errores","children":[{"content":"<strong>Middleware de Manejo de Errores</strong>","children":[{"content":"\n<p data-lines=\"72,73\">Captura errores no manejados por las rutas o middlewares anteriores.</p>","children":[],"payload":{"lines":"72,73"}},{"content":"\n<p data-lines=\"73,74\">Debe ir <strong>después de las rutas</strong> para manejar cualquier error generado en las rutas.</p>\n<pre><code class=\"language-typescript\">app.use(globalErrorHandler);\n</code></pre>","children":[],"payload":{"lines":"73,79"}}],"payload":{"lines":"71,79"}}],"payload":{"lines":"70,71"}},{"content":"6. Inicialización de la Base de Datos y Servidor","children":[{"content":"<strong>Inicialización y Configuración del Servidor</strong>","children":[{"content":"\n<p data-lines=\"81,82\">Conecta con la base de datos.</p>","children":[],"payload":{"lines":"81,82"}},{"content":"\n<p data-lines=\"82,83\">Inicia el servidor después de definir rutas y middlewares.</p>\n<pre><code class=\"language-typescript\">dataSource\n  .<span class=\"hljs-title function_\">initialize</span>()\n  .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">\"Connected to the database!\"</span>);\n    app.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-variable constant_\">PORT</span>, <span class=\"hljs-function\">() =&gt;</span> {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`Server running at PORT: <span class=\"hljs-subst\">${PORT}</span>`</span>);\n    });\n  })\n  .<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">error</span>) =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(<span class=\"hljs-string\">\"Error connecting to the database:\"</span>, error);\n  });\n</code></pre>","children":[],"payload":{"lines":"82,98"}}],"payload":{"lines":"80,98"}}],"payload":{"lines":"79,80"}},{"content":"Ejemplo Completo del Orden","children":[{"content":"<pre><code class=\"language-typescript\"><span class=\"hljs-keyword\">import</span> express <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"express\"</span>;\n<span class=\"hljs-keyword\">import</span> cors <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"cors\"</span>;\n<span class=\"hljs-keyword\">import</span> bodyParser <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"body-parser\"</span>;\n<span class=\"hljs-keyword\">import</span> helmet <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"helmet\"</span>;\n<span class=\"hljs-keyword\">import</span> compression <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"compression\"</span>;\n<span class=\"hljs-keyword\">import</span> morgan <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"morgan\"</span>;\n<span class=\"hljs-keyword\">import</span> dotenv <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"dotenv\"</span>;\n<span class=\"hljs-keyword\">import</span> dataSource <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./config/ormconfig\"</span>;\n<span class=\"hljs-keyword\">import</span> { globalErrorHandler } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./utils/errorHandler\"</span>;\n<span class=\"hljs-keyword\">import</span> routes <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./routes\"</span>;\n<span class=\"hljs-keyword\">import</span> { responseMiddleware } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">\"./utils/responseMiddleware\"</span>;\n\ndotenv.<span class=\"hljs-title function_\">config</span>();\n\n<span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">express</span>();\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">PORT</span> = process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">APP_PORT</span> || <span class=\"hljs-number\">3000</span>;\n\n<span class=\"hljs-comment\">// Configuración de middlewares generales</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">helmet</span>()); <span class=\"hljs-comment\">// Seguridad</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">compression</span>()); <span class=\"hljs-comment\">// Compresión</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">cors</span>()); <span class=\"hljs-comment\">// CORS</span>\napp.<span class=\"hljs-title function_\">use</span>(bodyParser.<span class=\"hljs-title function_\">json</span>()); <span class=\"hljs-comment\">// Análisis JSON</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">morgan</span>(<span class=\"hljs-string\">'combined'</span>)); <span class=\"hljs-comment\">// Registro de solicitudes</span>\n\n<span class=\"hljs-comment\">// Middleware de respuesta personalizado</span>\napp.<span class=\"hljs-title function_\">use</span>(responseMiddleware);\n\n<span class=\"hljs-comment\">// Definición de rutas</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">\"/api/\"</span>, routes);\n\n<span class=\"hljs-comment\">// Middleware de manejo de errores</span>\napp.<span class=\"hljs-title function_\">use</span>(globalErrorHandler);\n\n<span class=\"hljs-comment\">// Inicialización de la base de datos y inicio del servidor</span>\ndataSource\n  .<span class=\"hljs-title function_\">initialize</span>()\n  .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">\"Connected to the database!\"</span>);\n    app.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-variable constant_\">PORT</span>, <span class=\"hljs-function\">() =&gt;</span> {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`Server running at PORT: <span class=\"hljs-subst\">${PORT}</span>`</span>);\n    });\n  })\n  .<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">error</span>) =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(<span class=\"hljs-string\">\"Error connecting to the database:\"</span>, error);\n  });\n</code></pre>","children":[]}],"payload":{"lines":"98,99"}}],"payload":{"lines":"0,1"}},null)</script>
</body>
</html>
