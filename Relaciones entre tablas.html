<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.3-alpha.1/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.3-alpha.1/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.3-alpha.1/dist/index.js"></script><script>(()=>{setTimeout(()=>{const{markmap:q,mm:v}=window,j=new q.Toolbar;j.attach(v);const we=j.render();we.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(we)})})()</script><script>((f,d,h,u)=>{const g=f();window.mm=g.Markmap.create("svg#mindmap",(d||g.deriveOptions)(u),h)})(()=>window.markmap,null,{"content":"Cambios en Entidades","children":[{"content":"Product","children":[{"content":"\n<h3 data-lines=\"2,3\">Relación con SaleItem:</h3>","children":[{"content":"Reemplazo de <code>Product[]</code> con <code>SaleItem[]</code>.","children":[],"payload":{"lines":"3,4"}},{"content":"Implementación:<pre><code class=\"language-typescript\"><span class=\"hljs-meta\">@ManyToMany</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title class_\">Sale</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">sale</span>) =&gt;</span> sale.<span class=\"hljs-property\">sale_items</span>)\n<span class=\"hljs-meta\">@JoinTable</span>({\n  <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"sale_items\"</span>,\n  <span class=\"hljs-attr\">joinColumn</span>: { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"int_code\"</span>, <span class=\"hljs-attr\">referencedColumnName</span>: <span class=\"hljs-string\">\"int_code\"</span> },\n  <span class=\"hljs-attr\">inverseJoinColumn</span>: { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"sale_id\"</span>, <span class=\"hljs-attr\">referencedColumnName</span>: <span class=\"hljs-string\">\"sale_id\"</span> },\n})\nsale_items!: <span class=\"hljs-title class_\">SaleItem</span>[];\n</code></pre>","children":[],"payload":{"lines":"4,14"}},{"content":"<strong>Justificación</strong>:","children":[{"content":"Se realizó este cambio para mapear correctamente los elementos de venta asociados con productos.","children":[],"payload":{"lines":"15,17"}}],"payload":{"lines":"14,17"}}],"payload":{"lines":"2,17"}},{"content":"\n<h3 data-lines=\"17,18\">Relación con PurchaseItem:</h3>","children":[{"content":"Se mantiene la relación con <code>PurchaseItem[]</code>.","children":[],"payload":{"lines":"18,19"}},{"content":"Implementación:<pre><code class=\"language-typescript\"><span class=\"hljs-meta\">@ManyToMany</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title class_\">Purchase</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">purchase</span>) =&gt;</span> purchase.<span class=\"hljs-property\">purchase_items</span>)\n<span class=\"hljs-meta\">@JoinTable</span>({\n  <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"purchase_items\"</span>,\n  <span class=\"hljs-attr\">joinColumn</span>: { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"int_code\"</span>, <span class=\"hljs-attr\">referencedColumnName</span>: <span class=\"hljs-string\">\"int_code\"</span> },\n  <span class=\"hljs-attr\">inverseJoinColumn</span>: { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"purchase_id\"</span>, <span class=\"hljs-attr\">referencedColumnName</span>: <span class=\"hljs-string\">\"purchase_id\"</span> },\n})\npurchases!: <span class=\"hljs-title class_\">IPurchases</span>[];\n</code></pre>","children":[],"payload":{"lines":"19,30"}}],"payload":{"lines":"17,30"}},{"content":"\n<h3 data-lines=\"30,31\">Comentarios Eliminados:</h3>","children":[{"content":"Eliminados comentarios no necesarios en el código fuente:","children":[{"content":"<code>// Relación con PurchaseItem</code>","children":[],"payload":{"lines":"32,33"}},{"content":"<code>// Relación con SaleItem</code>","children":[],"payload":{"lines":"33,35"}}],"payload":{"lines":"31,35"}}],"payload":{"lines":"30,35"}}],"payload":{"lines":"1,2"}},{"content":"Sale","children":[{"content":"\n<h3 data-lines=\"36,37\">Relación con Customer:</h3>","children":[{"content":"No se realizaron cambios en la relación con <code>Customer</code>.","children":[],"payload":{"lines":"37,38"}},{"content":"Implementación:<pre><code class=\"language-typescript\"><span class=\"hljs-meta\">@ManyToOne</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title class_\">Customer</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">customer</span>) =&gt;</span> customer.<span class=\"hljs-property\">sales</span>, {\n  <span class=\"hljs-attr\">onDelete</span>: <span class=\"hljs-string\">\"SET NULL\"</span>,\n})\n<span class=\"hljs-meta\">@JoinColumn</span>({ <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"customer_id\"</span> })\ncustomer?: <span class=\"hljs-title class_\">Customer</span>;\n</code></pre>","children":[],"payload":{"lines":"38,47"}}],"payload":{"lines":"36,47"}},{"content":"\n<h3 data-lines=\"47,48\">Relación con SaleItem:</h3>","children":[{"content":"Relación <code>OneToMany</code> añadida entre <code>Sale</code> y <code>SaleItem</code>:<pre><code class=\"language-typescript\"><span class=\"hljs-meta\">@OneToMany</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title class_\">SaleItem</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">saleItem</span>) =&gt;</span> saleItem.<span class=\"hljs-property\">sale</span>, {\n  <span class=\"hljs-attr\">cascade</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">eager</span>: <span class=\"hljs-literal\">true</span>,\n})\nsale_items!: <span class=\"hljs-title class_\">SaleItem</span>[];\n</code></pre>","children":[],"payload":{"lines":"48,56"}},{"content":"<strong>Justificación</strong>:","children":[{"content":"Se agregó persistencia en cascada para asegurar que los <code>SaleItem</code> asociados se mantengan en sincronía con la entidad <code>Sale</code>.","children":[],"payload":{"lines":"57,59"}}],"payload":{"lines":"56,59"}}],"payload":{"lines":"47,59"}}],"payload":{"lines":"35,36"}},{"content":"SaleItem","children":[{"content":"\n<h3 data-lines=\"60,61\">Relación con Sale:</h3>","children":[{"content":"Relación <code>ManyToOne</code> establecida con <code>Sale</code>:<pre><code class=\"language-typescript\"><span class=\"hljs-meta\">@ManyToOne</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title class_\">Sale</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">sale</span>) =&gt;</span> sale.<span class=\"hljs-property\">sale_items</span>, { <span class=\"hljs-attr\">onDelete</span>: <span class=\"hljs-string\">\"CASCADE\"</span> })\n<span class=\"hljs-meta\">@JoinColumn</span>({ <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"sale_id\"</span> })\nsale!: <span class=\"hljs-title class_\">Sale</span>;\n</code></pre>","children":[],"payload":{"lines":"61,67"}},{"content":"<strong>Justificación</strong>:","children":[{"content":"Permite la eliminación en cascada de los <code>SaleItem</code> cuando la entidad <code>Sale</code> se elimina.","children":[],"payload":{"lines":"68,70"}}],"payload":{"lines":"67,70"}}],"payload":{"lines":"60,70"}},{"content":"\n<h3 data-lines=\"70,71\">Relación con Product:</h3>","children":[{"content":"Relación con <code>Product</code> comentada temporalmente:<pre><code class=\"language-typescript\"><span class=\"hljs-comment\">// @ManyToOne(() =&gt; Product, (product) =&gt; product.sale_items, {</span>\n<span class=\"hljs-comment\">//   onDelete: \"CASCADE\"</span>\n<span class=\"hljs-comment\">// })</span>\n<span class=\"hljs-comment\">// @JoinColumn({ name: \"product_id\" })</span>\n<span class=\"hljs-comment\">// product?: Product;</span>\n</code></pre>","children":[],"payload":{"lines":"71,79"}},{"content":"<strong>Justificación</strong>:","children":[{"content":"Pendiente de revisión por un posible problema de recursividad en las relaciones.","children":[],"payload":{"lines":"80,82"}}],"payload":{"lines":"79,82"}}],"payload":{"lines":"70,82"}}],"payload":{"lines":"59,60"}},{"content":"Purchase","children":[{"content":"\n<h3 data-lines=\"83,84\">Relación con PurchaseItem:</h3>","children":[{"content":"Definición de la relación <code>OneToMany</code>:<pre><code class=\"language-typescript\"><span class=\"hljs-meta\">@OneToMany</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title class_\">PurchaseItem</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">purchaseItem</span>) =&gt;</span> purchaseItem.<span class=\"hljs-property\">purchase</span>, {\n  <span class=\"hljs-attr\">cascade</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">eager</span>: <span class=\"hljs-literal\">true</span>,\n})\npurchase_items!: <span class=\"hljs-title class_\">PurchaseItem</span>[];\n</code></pre>","children":[],"payload":{"lines":"84,92"}},{"content":"<strong>Justificación</strong>:","children":[{"content":"Persistencia en cascada para asegurar que los <code>PurchaseItem</code> asociados se mantengan sincronizados con la entidad <code>Purchase</code>.","children":[],"payload":{"lines":"93,95"}}],"payload":{"lines":"92,95"}}],"payload":{"lines":"83,95"}}],"payload":{"lines":"82,83"}},{"content":"PurchaseItem","children":[{"content":"\n<h3 data-lines=\"96,97\">Relación con Purchase:</h3>","children":[{"content":"Definición de la relación <code>ManyToOne</code> con <code>Purchase</code>:<pre><code class=\"language-typescript\"><span class=\"hljs-meta\">@ManyToOne</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title class_\">Purchase</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">purchase</span>) =&gt;</span> purchase.<span class=\"hljs-property\">purchase_items</span>, { <span class=\"hljs-attr\">onDelete</span>: <span class=\"hljs-string\">\"CASCADE\"</span> })\n<span class=\"hljs-meta\">@JoinColumn</span>({ <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"purchase_id\"</span> })\npurchase!: <span class=\"hljs-title class_\">Purchase</span>;\n</code></pre>","children":[],"payload":{"lines":"97,104"}}],"payload":{"lines":"96,104"}}],"payload":{"lines":"95,96"}},{"content":"Cambios Globales","children":[{"content":"\n<h3 data-lines=\"105,106\">Ajuste de Tipos de Relación:</h3>","children":[{"content":"Ajustes en <code>Product</code> para asociarse a <code>SaleItem[]</code> en lugar de <code>Product[]</code>.","children":[],"payload":{"lines":"106,108"}}],"payload":{"lines":"105,108"}},{"content":"\n<h3 data-lines=\"108,109\">Persistencia en Cascada:</h3>","children":[{"content":"Se agregó <code>cascade: true</code> en relaciones <code>Sale</code> y <code>SaleItem</code>.","children":[],"payload":{"lines":"109,111"}}],"payload":{"lines":"108,111"}},{"content":"\n<h3 data-lines=\"111,112\">Eliminación de Comentarios:</h3>","children":[{"content":"Se removieron comentarios innecesarios para mejorar la legibilidad del código.","children":[],"payload":{"lines":"112,114"}}],"payload":{"lines":"111,114"}},{"content":"\n<h3 data-lines=\"114,115\">Pendiente de Revisión:</h3>","children":[{"content":"Revisión pendiente de la relación <code>ManyToOne</code> entre <code>SaleItem</code> y <code>Product</code>.","children":[],"payload":{"lines":"115,116"}}],"payload":{"lines":"114,116"}}],"payload":{"lines":"104,105"}}],"payload":{"lines":"0,1"}},null)</script>
</body>
</html>
